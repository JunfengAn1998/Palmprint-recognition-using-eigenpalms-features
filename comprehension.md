DIP课程中要求做个掌纹识别项目，于是找出老板2002年的一篇论文来读，捋了捋思路，补一下基础，欢迎批评指正。

**目 录**

[1、 特征提取阶段理想步骤 ](#特征提取阶段理想步骤)

[2、 潜在的问题 ](#2.潜在的问题)


[3、 本文提出的解决方案 ](#3.本文提出的解决方案)





概述：
本文提出了一种基于特征空间技术的掌纹识别方法。利用Karhunen Loeve变换将原始掌纹图像转化为一个小的特征空间集合，称为特征掌纹，它是训练集的特征向量，可以很好地表示掌纹的主成分。然后，将一幅新的掌纹图像投影到由掌纹组成的子空间中，提取掌纹特征，并利用欧式距离分类器进行掌纹识别。实验结果表明了该方法在识别率方面的有效性。

**1.特征提取阶段理想步骤：**
========


1).  将所有训练样本转换成单列向量（M为样本数；将像素列顺序拼接，变成单列），使用所有训练集数据计算平均掌纹列向量μ。

![image2](http://121.36.17.237:8090/upload/2020/05/image2-0c309748bbe14829831fe1f61e564e73.png)（1）

2).  将每一个训练数据变成列向量，与平均掌纹求出差向量。乘以转置得到协方差矩阵，求出平均的[协方差矩阵C](http://121.36.17.237:8090/archives/%E5%8D%8F%E6%96%B9%E5%B7%AE%E7%9F%A9%E9%98%B5)。

![image3](http://121.36.17.237:8090/upload/2020/05/image3-a3ee8d1e5f414ece99c150adb8d5f333.png)（2）

![image4](http://121.36.17.237:8090/upload/2020/05/image4-d6fc6eefd7c1490daf5f8ec2c89af1dc.png)（3）

![image5](http://121.36.17.237:8090/upload/2020/05/image5-8d0a65752b70401cb3465902f50cff79.png)（4）

上式X∈（X∈N\^2×M），表示所有训练样本的偏差组成的矩阵。

3).  对协方差矩阵C进行K-L变换，在变换矩阵主对角线上得到多个特征值。（[有关K-L变换的知识](http://121.36.17.237:8090/archives/k-l%E5%8F%98%E6%8D%A2)）

4).  取特征值前q大的，之后计算他们对应的特征向量。这些特征向量就作为掌纹空间的“基”。


**2.潜在的问题**
========

1)上面的C（C∈N\^2×N\^2），矩阵维度过大，不容易计算特征值，


**3.本文提出的解决方案**
========

1).  将X转置与X左右互换得到矩阵L。

![image6](http://121.36.17.237:8090/upload/2020/05/image6-7b556cf7d3784783bb7d2a5a07ff8525.png)（5）

2).  设ak和vk分别为特征值和特征向量。（通过K-L变换的变换矩阵可以直接计算出L的特征值ak和特征向量vk。个人理解为：对应每一个训练样本都贡献一个特征值和特征向量。）

3).  于是得到下式：

![image7](http://121.36.17.237:8090/upload/2020/05/image7-13f49c26763b42d1b6aa59fd966e2c47.png)（6）

4).  对（6）的特征向量全部左乘X，得到（7），（7）等号左侧凑出了原矩阵C。

![image8](http://121.36.17.237:8090/upload/2020/05/image8-b5138900f48c425c8e0eadb4dac4fe36.png)（7）

5).根据特征值以及特征向量的定义对于矩阵C有：

![image9](http://121.36.17.237:8090/upload/2020/05/image9-c68b3aed5d1e40bc81e79936a7a3cdfb.png)

   对应（7）有

![image10](http://121.36.17.237:8090/upload/2020/05/image10-39403582938a4ff0ac902fcf1c680097.png)（8）

6).  于是我们通过上面方法计算，得到了“理想步骤”中矩阵C的特征向量，这些向量uk就作为原掌纹空间的“基”向量。

7).  对应矩阵大小，不难看出特征向量uk（uk∈N\^2×1），接下来将它reshape回到N×N尺寸，将该图像作为从k号训练数据提取出的“特征手掌”（因为我们有M个训练样本，所以有M个列向量，对应着M特征向量。）

![image11](http://121.36.17.237:8090/upload/2020/05/image11-fdac773b538e494cae8290ede0cbd524.png)

8).  继续优化：根据主成分分析理论，认为不需要选择所有的训练样本的特征向量作为基向量，而是只需要那些与最大特征值对应的特征向量就可以很好地表示训练集的特征。于是，将矩阵列向量维度继续减少，再进行转置得到U’：

![image12](http://121.36.17.237:8090/upload/2020/05/image12-e7cbc3bdb73d48a482ddcd96a064d4a4.png)

（9）

U’尺寸: M’×N\^2

9).  对于每一个新输入的“掌纹图片”先压缩为N\^2×1的列向量；

再减去“平均掌纹”（去掉所有手掌都有的无用特征）；

使用U’ 矩阵对它进行特征变换，得到该掌纹的“特征”fi ，

![image13](http://121.36.17.237:8090/upload/2020/05/image13-9ff5ef9d73f3451783bb449399d1a015.png)
![image14](http://121.36.17.237:8090/upload/2020/05/image14-bbb74a578d6146ec8ea3debfcfb76b13.png)
![image15](http://121.36.17.237:8090/upload/2020/05/image15-0c14bdf0bbf9492098059706f2ced1cd.png)

至此已经将训练样本中的特征按照本文提出的方法提取完毕。
